"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[616],{1718:(e,n,r)=>{r.d(n,{Ay:()=>o,RM:()=>i});var d=r(4848),s=r(8453);const i=[];function t(e){const n={code:"code",li:"li",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Web Banking"})," (",(0,d.jsx)(n.code,{children:"banking"}),"): banking interface where users can manage their financial needs around transactions, cards, payments, and memberships"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Onboarding"})," (",(0,d.jsx)(n.code,{children:"onboarding"}),"): process of opening new accounts for your users that follows specific steps to meet legal requirements"]}),"\n"]})}function o(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(t,{...e})}):t(e)}},9611:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>x,frontMatter:()=>t,metadata:()=>c,toc:()=>h});var d=r(4848),s=r(8453),i=r(1718);const t={},o="Build and deploy",c={id:"build-deploy",title:"Build and deploy",description:"Bundle",source:"@site/docs/build-deploy.mdx",sourceDirName:".",slug:"/build-deploy",permalink:"/swan-partner-frontend/build-deploy",draft:!1,unlisted:!1,editUrl:"https://github.com/swan-io/swan-partner-frontend/edit/main/docs/docs/build-deploy.mdx",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"GraphQL",permalink:"/swan-partner-frontend/graphql"},next:{title:"Deploy as is on your infra",permalink:"/swan-partner-frontend/deploy-as-is"}},l={},h=[{value:"Bundle",id:"bundle",level:2},{value:"Dockerize",id:"dockerize",level:2},{value:"Required environment variables",id:"required-environment-variables",level:2},{value:"Exposing the app",id:"exposing-the-app",level:2},...i.RM,{value:"Routing",id:"routing",level:2},{value:"Content delivery network",id:"content-delivery-network",level:2}];function a(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.h1,{id:"build-and-deploy",children:"Build and deploy"}),"\n",(0,d.jsx)(n.h2,{id:"bundle",children:"Bundle"}),"\n",(0,d.jsxs)(n.p,{children:["Bundle the client applications and the server in ",(0,d.jsx)(n.code,{children:"./server"})," in production with the following command:"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-console",children:"$ pnpm build\n"})}),"\n",(0,d.jsx)(n.h2,{id:"dockerize",children:"Dockerize"}),"\n",(0,d.jsx)(n.p,{children:"Create a Docker image from the built files:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-console",children:"$ docker build\n"})}),"\n",(0,d.jsx)(n.h2,{id:"required-environment-variables",children:"Required environment variables"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Variable"}),(0,d.jsx)(n.th,{children:"Description"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Environment"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"NODE_ENV"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.em,{children:"development"})," or ",(0,d.jsx)(n.em,{children:"production"})]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Environment"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LOG_LEVEL"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.em,{children:"fatal"}),", ",(0,d.jsx)(n.em,{children:"error"}),", ",(0,d.jsx)(n.em,{children:"warn"}),", ",(0,d.jsx)(n.em,{children:"info"}),", ",(0,d.jsx)(n.em,{children:"debug"}),", ",(0,d.jsx)(n.em,{children:"trace"}),", or ",(0,d.jsx)(n.em,{children:"silent"})]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"API"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"PARTNER_API_URL"})}),(0,d.jsx)(n.td,{children:"Swan Partner API URL"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"API"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"UNAUTHENTICATED_API_URL"})}),(0,d.jsx)(n.td,{children:"Swan Unauthenticated API URL"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"API"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"OAUTH_SERVER_URL"})}),(0,d.jsx)(n.td,{children:"Swan OAuth2 server URL"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"API"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"OAUTH_CLIENT_ID"})}),(0,d.jsx)(n.td,{children:"your Swan project's OAuth2 Client ID"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"API"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"OAUTH_CLIENT_SECRET"})}),(0,d.jsx)(n.td,{children:"your Swan project's OAuth2 Client Secret"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Sessions"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"COOKIE_KEY"})}),(0,d.jsxs)(n.td,{children:["key to encrypt session cookies",(0,d.jsx)("br",{}),"(generate using ",(0,d.jsx)(n.code,{children:"pnpm generate-cookie-key"}),")"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"URLs to expose"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"BANKING_URL"})}),(0,d.jsx)(n.td,{children:"URL for the banking app"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"URLs to expose"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ONBOARDING_URL"})}),(0,d.jsx)(n.td,{children:"URL for the onboarding process"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"URLs to expose"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"PAYMENT_URL"})}),(0,d.jsx)(n.td,{children:"URL for the payment process"})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"exposing-the-app",children:"Exposing the app"}),"\n",(0,d.jsxs)(n.p,{children:["The server is a ",(0,d.jsx)(n.strong,{children:"single application"})," that serves both banking and onboarding domains."]}),"\n",(0,d.jsx)(i.Ay,{}),"\n",(0,d.jsx)(n.admonition,{type:"tip",children:(0,d.jsxs)(n.p,{children:["We recommend pointing both subdomains ",(0,d.jsx)(n.strong,{children:"to the same application"})," so that you don't have any sync issues between onboarding and banking."]})}),"\n",(0,d.jsx)(n.h2,{id:"routing",children:"Routing"}),"\n",(0,d.jsxs)(n.p,{children:["In order to route to the correct client given the domain, the server uses the ",(0,d.jsx)(n.code,{children:"x-forwarded-host"})," or ",(0,d.jsx)(n.code,{children:"host"})," header."]}),"\n",(0,d.jsx)(n.h2,{id:"content-delivery-network",children:"Content delivery network"}),"\n",(0,d.jsxs)(n.p,{children:["In order to avoid stale content or too many hits, we recommended applying a ",(0,d.jsx)(n.strong,{children:"cache policy"})," in your app's ",(0,d.jsx)(n.strong,{children:"HTTP response headers"}),"."]})]})}function x(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>o});var d=r(6540);const s={},i=d.createContext(s);function t(e){const n=d.useContext(i);return d.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),d.createElement(i.Provider,{value:n},e.children)}}}]);